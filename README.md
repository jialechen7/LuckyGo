# LuckyGoï¼šåŸºäº go-zero æ¡†æ¶çš„å¾®æœåŠ¡æŠ½å¥–ç³»ç»Ÿ

[![Go](https://img.shields.io/badge/Go-1.23+-00ADD8?style=for-the-badge&logo=go)](https://golang.org/)
[![Go-Zero](https://img.shields.io/badge/go--zero-1.7.4-blue?style=for-the-badge)](https://github.com/zeromicro/go-zero)
[![Docker](https://img.shields.io/badge/Docker-20.10+-2496ED?style=for-the-badge&logo=docker)](https://www.docker.com/)
[![MySQL](https://img.shields.io/badge/MySQL-8.0+-4479A1?style=for-the-badge&logo=mysql)](https://www.mysql.com/)
[![Redis](https://img.shields.io/badge/Redis-7.0+-DC382D?style=for-the-badge&logo=redis)](https://redis.io/)

## ğŸ“– é¡¹ç›®ç®€ä»‹

LuckyGo æ˜¯ä¸€ä¸ªåŸºäº [go-zero](https://github.com/zeromicro/go-zero) æ¡†æ¶å¼€å‘çš„ä¼ä¸šçº§é«˜æ€§èƒ½æŠ½å¥–ç³»ç»Ÿåå°ã€‚è¯¥ç³»ç»Ÿé‡‡ç”¨å¾®æœåŠ¡æ¶æ„ï¼Œæ—¨åœ¨æä¾›çµæ´»ã€å¯é ã€æ‰©å±•æ€§å¼ºçš„æŠ½å¥–å¹³å°ï¼Œæ»¡è¶³å¤šç§ä¸šåŠ¡åœºæ™¯éœ€æ±‚ã€‚

### âœ¨ æ ¸å¿ƒç‰¹æ€§

- ğŸ¯ **å®Œæ•´çš„æŠ½å¥–ç”Ÿæ€**: æ”¯æŒå³æ—¶æŠ½å¥–ã€å®šæ—¶æŠ½å¥–ã€å¤šç§å¥–å“ç±»å‹é…ç½®
- ğŸ‘¥ **ç”¨æˆ·ä½“ç³»**: å®Œæ•´çš„ç”¨æˆ·æ³¨å†Œã€ç™»å½•ã€èµ„æ–™ç®¡ç†ï¼Œæ”¯æŒå¾®ä¿¡å°ç¨‹åºæˆæƒ
- ğŸ“ **è¯„è®ºäº’åŠ¨**: è¯„è®ºç³»ç»Ÿï¼Œæ”¯æŒç‚¹èµã€å›å¤ç­‰ç¤¾äº¤åŠŸèƒ½
- ğŸ“… **ç­¾åˆ°ç³»ç»Ÿ**: æ¯æ—¥ç­¾åˆ°ã€ä»»åŠ¡ç³»ç»Ÿã€ç§¯åˆ†ä½“ç³»
- ğŸ“ **æ–‡ä»¶ç®¡ç†**: ç»Ÿä¸€çš„æ–‡ä»¶ä¸Šä¼ æœåŠ¡ï¼Œæ”¯æŒ MinIO å¯¹è±¡å­˜å‚¨
- ğŸ”” **æ¶ˆæ¯é€šçŸ¥**: å¾®ä¿¡å°ç¨‹åºæ¶ˆæ¯æ¨é€ã€äº‹ä»¶é€šçŸ¥
- ğŸ“Š **å®æ—¶ç›‘æ§**: é“¾è·¯è¿½è¸ªã€æ—¥å¿—æ”¶é›†ã€æ€§èƒ½ç›‘æ§

### ğŸ¯ é€‚ç”¨åœºæ™¯

- ç”µå•†å¹³å°æŠ½å¥–æ´»åŠ¨
- è¥é”€æ¨å¹¿æ´»åŠ¨
- ç”¨æˆ·å¢é•¿æ´»åŠ¨
- ç¤¾åŒºäº’åŠ¨å¹³å°
- å°ç¨‹åºæŠ½å¥–åº”ç”¨

## ğŸ“‹ é¡¹ç›®èƒŒæ™¯

æœ¬é¡¹ç›®å‚è€ƒäº† [go-zero-looklook](https://github.com/Mikaelemmmm/go-zero-looklook) çš„æ¶æ„è®¾è®¡æ€è·¯ï¼Œå¹¶åœ¨æ­¤åŸºç¡€ä¸Šè¿›è¡Œäº†åŠŸèƒ½æ‰©å±•ä¸ä¼˜åŒ–ï¼Œå½¢æˆäº†ä¸€å¥—å®Œæ•´çš„æŠ½å¥–ç³»ç»Ÿè§£å†³æ–¹æ¡ˆã€‚é¡¹ç›®ç‰¹åˆ«æ³¨é‡ä»£ç è§„èŒƒã€æ¶æ„è®¾è®¡å’Œå¯ç»´æŠ¤æ€§ï¼Œé€‚åˆä½œä¸ºå¾®æœåŠ¡å­¦ä¹ å’Œå®è·µçš„å‚è€ƒé¡¹ç›®ã€‚

## ğŸ—ï¸ æŠ€æœ¯æ ˆ

### æ ¸å¿ƒæ¡†æ¶
- **[go-zero](https://github.com/zeromicro/go-zero)** - é«˜æ€§èƒ½å¾®æœåŠ¡æ¡†æ¶ï¼Œæä¾›ä¸°å¯Œçš„ä¸­é—´ä»¶å’Œå·¥å…·
- **[gRPC](https://grpc.io/)** - é«˜æ€§èƒ½ RPC æ¡†æ¶ï¼Œç”¨äºæœåŠ¡é—´é€šä¿¡
- **[Gorm](https://gorm.io/)** - Go è¯­è¨€ ORM åº“ï¼Œç®€åŒ–æ•°æ®åº“æ“ä½œ

### æ•°æ®å­˜å‚¨
- **[MySQL 8.0+](https://www.mysql.com/)** - ä¸»æ•°æ®åº“ï¼Œå­˜å‚¨ä¸šåŠ¡æ•°æ®
- **[Redis 7.0+](https://redis.io/)** - ç¼“å­˜ä¸åˆ†å¸ƒå¼é”ï¼Œæå‡ç³»ç»Ÿæ€§èƒ½
- **[MinIO](https://min.io/)** - å¯¹è±¡å­˜å‚¨æœåŠ¡ï¼Œå¤„ç†æ–‡ä»¶ä¸Šä¼ 

### æ¶ˆæ¯ä¸ä»»åŠ¡
- **[Asynq](https://github.com/hibiken/asynq)** - å¼‚æ­¥ä»»åŠ¡é˜Ÿåˆ—ï¼Œå¤„ç†åå°ä»»åŠ¡
- **[Kafka](https://kafka.apache.org/)** - æ¶ˆæ¯é˜Ÿåˆ—ï¼Œç”¨äºæ—¥å¿—æ”¶é›†å’Œäº‹ä»¶é©±åŠ¨

### ç›‘æ§ä¸è¿ç»´
- **[Jaeger](https://www.jaegertracing.io/)** - åˆ†å¸ƒå¼é“¾è·¯è¿½è¸ª
- **[Elasticsearch](https://www.elastic.co/)** - æ—¥å¿—å­˜å‚¨ä¸æœç´¢
- **[Filebeat](https://www.elastic.co/beats/filebeat)** - æ—¥å¿—æ”¶é›†
- **[Go-stash](https://github.com/kevwan/go-stash)** - æ—¥å¿—å¤„ç†ç®¡é“
- **[etcd](https://etcd.io/)** - æœåŠ¡å‘ç°ä¸é…ç½®ç®¡ç†

### éƒ¨ç½²å·¥å…·
- **[Docker](https://www.docker.com/)** - å®¹å™¨åŒ–éƒ¨ç½²
- **[Docker Compose](https://docs.docker.com/compose/)** - æœ¬åœ°å¼€å‘ç¯å¢ƒç¼–æ’
- **[Kubernetes](https://kubernetes.io/)** - ç”Ÿäº§ç¯å¢ƒå®¹å™¨ç¼–æ’

## ğŸ›ï¸ ç³»ç»Ÿæ¶æ„

### å¾®æœåŠ¡æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   API Gateway   â”‚    â”‚     Frontend    â”‚    â”‚  WeChat Mini    â”‚
â”‚     (Nginx)     â”‚    â”‚                 â”‚    â”‚    Program      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                      â”‚                      â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚    Load Balancer         â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                       â”‚                        â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”
â”‚  UserCenter   â”‚    â”‚      Lottery        â”‚    â”‚    Upload     â”‚
â”‚   Service     â”‚    â”‚      Service        â”‚    â”‚   Service     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                       â”‚                        â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”
â”‚    Comment    â”‚    â”‚      Checkin        â”‚    â”‚    Notice     â”‚
â”‚   Service     â”‚    â”‚      Service        â”‚    â”‚   Service     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                       â”‚                        â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚    Message Queue       â”‚
                    â”‚   (Scheduler + Job)    â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ ¸å¿ƒæœåŠ¡è¯´æ˜

| æœåŠ¡å | åŠŸèƒ½æè¿° | ä¸»è¦ç‰¹æ€§ |
|--------|----------|----------|
| **usercenter** | ç”¨æˆ·ä¸­å¿ƒæœåŠ¡ | ç”¨æˆ·æ³¨å†Œ/ç™»å½•ã€å¾®ä¿¡æˆæƒã€ç”¨æˆ·ä¿¡æ¯ç®¡ç† |
| **lottery** | æŠ½å¥–æ ¸å¿ƒæœåŠ¡ | æŠ½å¥–æ´»åŠ¨ç®¡ç†ã€å³æ—¶/å®šæ—¶æŠ½å¥–ã€ä¸­å¥–è®°å½• |
| **upload** | æ–‡ä»¶ä¸Šä¼ æœåŠ¡ | å›¾ç‰‡/æ–‡ä»¶ä¸Šä¼ ã€MinIO é›†æˆã€æ–‡ä»¶ç®¡ç† |
| **comment** | è¯„è®ºç³»ç»ŸæœåŠ¡ | è¯„è®ºå‘å¸ƒã€ç‚¹èµåŠŸèƒ½ã€è¯„è®ºç®¡ç† |
| **checkin** | ç­¾åˆ°ç³»ç»ŸæœåŠ¡ | æ¯æ—¥ç­¾åˆ°ã€ä»»åŠ¡ç³»ç»Ÿã€ç§¯åˆ†ç®¡ç† |
| **notice** | é€šçŸ¥æœåŠ¡ | å¾®ä¿¡æ¶ˆæ¯æ¨é€ã€äº‹ä»¶é€šçŸ¥ã€æ¶ˆæ¯å›è°ƒ |
| **mqueue** | æ¶ˆæ¯é˜Ÿåˆ—æœåŠ¡ | å®šæ—¶ä»»åŠ¡è°ƒåº¦ã€å¼‚æ­¥ä»»åŠ¡å¤„ç† |

## ğŸ“ é¡¹ç›®ç»“æ„

```
LuckyGo/
â”œâ”€â”€ app/                           # åº”ç”¨æœåŠ¡å±‚
â”‚   â”œâ”€â”€ checkin/                   # ç­¾åˆ°æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ cmd/
â”‚   â”‚   â”‚   â”œâ”€â”€ api/              # HTTP API æœåŠ¡
â”‚   â”‚   â”‚   â””â”€â”€ rpc/              # gRPC æœåŠ¡  
â”‚   â”‚   â””â”€â”€ model/                # æ•°æ®æ¨¡å‹
â”‚   â”œâ”€â”€ comment/                   # è¯„è®ºæœåŠ¡
â”‚   â”œâ”€â”€ lottery/                   # æŠ½å¥–æœåŠ¡
â”‚   â”œâ”€â”€ mqueue/                    # æ¶ˆæ¯é˜Ÿåˆ—æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ cmd/
â”‚   â”‚   â”‚   â”œâ”€â”€ job/              # å¼‚æ­¥ä»»åŠ¡å¤„ç†
â”‚   â”‚   â”‚   â””â”€â”€ scheduler/        # å®šæ—¶ä»»åŠ¡è°ƒåº¦
â”‚   â”œâ”€â”€ notice/                    # é€šçŸ¥æœåŠ¡
â”‚   â”œâ”€â”€ upload/                    # æ–‡ä»¶ä¸Šä¼ æœåŠ¡
â”‚   â””â”€â”€ usercenter/                # ç”¨æˆ·ä¸­å¿ƒæœåŠ¡
â”œâ”€â”€ common/                        # å…¬å…±æ¨¡å—
â”‚   â”œâ”€â”€ constants/                 # å¸¸é‡å®šä¹‰
â”‚   â”œâ”€â”€ interceptor/               # æ‹¦æˆªå™¨
â”‚   â”œâ”€â”€ response/                  # å“åº”æ¨¡å‹
â”‚   â”œâ”€â”€ utility/                   # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ wxnotice/                  # å¾®ä¿¡é€šçŸ¥
â”‚   â””â”€â”€ xerr/                      # é”™è¯¯å®šä¹‰
â”œâ”€â”€ deploy/                        # éƒ¨ç½²ç›¸å…³
â”‚   â”œâ”€â”€ filebeat/                  # æ—¥å¿—æ”¶é›†é…ç½®
â”‚   â”œâ”€â”€ go-stash/                  # æ—¥å¿—å¤„ç†é…ç½®
â”‚   â”œâ”€â”€ goctl/                     # ä»£ç ç”Ÿæˆæ¨¡æ¿
â”‚   â”œâ”€â”€ nginx/                     # ç½‘å…³é…ç½®
â”‚   â”œâ”€â”€ scripts/                   # éƒ¨ç½²è„šæœ¬
â”‚   â””â”€â”€ sql/                       # æ•°æ®åº“è„šæœ¬
â”œâ”€â”€ doc/                           # æ–‡æ¡£ç›®å½•
â”‚   â””â”€â”€ swagger/                   # API æ–‡æ¡£
â”œâ”€â”€ docker-compose-env.yml         # å¼€å‘ç¯å¢ƒç¼–æ’
â”œâ”€â”€ docker-compose.yml             # åº”ç”¨æœåŠ¡ç¼–æ’
â”œâ”€â”€ Makefile                       # æ„å»ºè„šæœ¬
â””â”€â”€ modd.conf                      # çƒ­é‡è½½é…ç½®
```

### æœåŠ¡ç»“æ„è¯´æ˜

æ¯ä¸ªå¾®æœåŠ¡éƒ½éµå¾ªç»Ÿä¸€çš„ç›®å½•ç»“æ„ï¼š

```
service/
â”œâ”€â”€ cmd/
â”‚   â”œâ”€â”€ api/                       # HTTP API å±‚
â”‚   â”‚   â”œâ”€â”€ desc/                  # API å®šä¹‰æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ etc/                   # é…ç½®æ–‡ä»¶
â”‚   â”‚   â””â”€â”€ internal/
â”‚   â”‚       â”œâ”€â”€ config/            # é…ç½®ç»“æ„
â”‚   â”‚       â”œâ”€â”€ handler/           # è¯·æ±‚å¤„ç†å™¨
â”‚   â”‚       â”œâ”€â”€ logic/             # ä¸šåŠ¡é€»è¾‘
â”‚   â”‚       â”œâ”€â”€ svc/               # æœåŠ¡ä¸Šä¸‹æ–‡
â”‚   â”‚       â””â”€â”€ types/             # ç±»å‹å®šä¹‰
â”‚   â””â”€â”€ rpc/                       # gRPC æœåŠ¡å±‚
â”‚       â”œâ”€â”€ etc/                   # é…ç½®æ–‡ä»¶
â”‚       â”œâ”€â”€ internal/
â”‚       â”‚   â”œâ”€â”€ config/            # é…ç½®ç»“æ„
â”‚       â”‚   â”œâ”€â”€ logic/             # ä¸šåŠ¡é€»è¾‘
â”‚       â”‚   â”œâ”€â”€ server/            # æœåŠ¡ç«¯å®ç°
â”‚       â”‚   â””â”€â”€ svc/               # æœåŠ¡ä¸Šä¸‹æ–‡
â”‚       â””â”€â”€ pb/                    # Protocol Buffer æ–‡ä»¶
â””â”€â”€ model/                         # æ•°æ®æ¨¡å‹ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ğŸ“‹ ç¯å¢ƒè¦æ±‚

- **Go** 1.23+ 
- **Docker** 20.10+
- **Docker Compose** 2.0+
- **MySQL** 8.0+ (å¯é€šè¿‡ Docker å¯åŠ¨)
- **Redis** 7.0+ (å¯é€šè¿‡ Docker å¯åŠ¨)

### âš¡ ä¸€é”®å¯åŠ¨

#### 1. å…‹éš†é¡¹ç›®
```bash
git clone https://github.com/jialechen7/go-lottery.git
cd go-lottery
```

#### 2. ç¯å¢ƒé…ç½®
```bash
# å¤åˆ¶ç¯å¢ƒå˜é‡æ–‡ä»¶
cp .env.example .env

# æ ¹æ®éœ€è¦ä¿®æ”¹é…ç½®
vim .env
```

#### 3. å¯åŠ¨æœåŠ¡

**ä½¿ç”¨ Make å‘½ä»¤ï¼ˆæ¨èï¼‰:**
```bash
# å¯åŠ¨åŸºç¡€ç¯å¢ƒ (MySQL, Redis, Kafka, etc.)
make docker-up-env

# ç­‰å¾…ç¯å¢ƒå°±ç»ªåï¼Œå¯åŠ¨åº”ç”¨æœåŠ¡
make docker-up-app
```

**æˆ–ä½¿ç”¨ Docker Compose:**
```bash
# å¯åŠ¨åŸºç¡€ç¯å¢ƒ
docker-compose -f docker-compose-env.yml up -d

# å¯åŠ¨åº”ç”¨æœåŠ¡
docker-compose -f docker-compose.yml up -d
```

#### 4. éªŒè¯æœåŠ¡
```bash
# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
docker-compose ps

# æŸ¥çœ‹æœåŠ¡æ—¥å¿—
docker-compose logs -f go-lottery
```

#### 5. è®¿é—®æœåŠ¡
- **API ç½‘å…³**: http://localhost:8889
- **Swagger æ–‡æ¡£**: æŸ¥çœ‹ `doc/swagger/` ç›®å½•
- **å¥åº·æ£€æŸ¥**: å„æœåŠ¡æä¾› `/health` ç«¯ç‚¹

### ğŸ›‘ åœæ­¢æœåŠ¡
```bash
# åœæ­¢åº”ç”¨æœåŠ¡
make docker-down-app

# åœæ­¢åŸºç¡€ç¯å¢ƒ
make docker-down-env
```

## ğŸ”§ å¼€å‘æŒ‡å—

### ğŸ—ï¸ ä»£ç ç”Ÿæˆå·¥ä½œæµ

æœ¬é¡¹ç›®ä½¿ç”¨ goctl å·¥å…·è¿›è¡Œä»£ç ç”Ÿæˆï¼Œéµå¾ªä»¥ä¸‹å¼€å‘æµç¨‹ï¼š

#### 1. æ•°æ®åº“è®¾è®¡ä¸æ¨¡å‹ç”Ÿæˆ

é¦–å…ˆè®¾è®¡æ•°æ®åº“è¡¨ç»“æ„ï¼Œç„¶åä½¿ç”¨è„šæœ¬ç”Ÿæˆ Model å±‚ï¼š

```bash
# ç”Ÿæˆæ•°æ®æ¨¡å‹
./deploy/scripts/mysql/genModel.sh <æ•°æ®åº“å> <è¡¨å> <ç›®æ ‡ç›®å½•> <æ¨¡æ¿ç›®å½•>

# ç¤ºä¾‹ï¼šä¸ºç”¨æˆ·ä¸­å¿ƒç”Ÿæˆç”¨æˆ·è¡¨æ¨¡å‹
./deploy/scripts/mysql/genModel.sh usercenter user app/usercenter/model deploy/goctl/1.7.3

# æˆ–ä½¿ç”¨ Make å‘½ä»¤
make gen-model-usercenter
```

#### 2. API æœåŠ¡å¼€å‘

è®¾è®¡ API æ¥å£å®šä¹‰ï¼Œç”Ÿæˆ HTTP æœåŠ¡ä»£ç ï¼š

```bash
# ç”Ÿæˆ API ä»£ç 
goctl api go --api=<APIæ–‡ä»¶> --dir=<ç›®æ ‡ç›®å½•> --style=go_zero --home=deploy/goctl/1.7.3/

# ç”Ÿæˆ Swagger æ–‡æ¡£
goctl api plugin --plugin=goctl-swagger="swagger -filename <æœåŠ¡å>.json" --api=<APIæ–‡ä»¶> --dir=doc/swagger

# ç¤ºä¾‹ï¼šç”Ÿæˆç”¨æˆ·ä¸­å¿ƒ API
make gen-api-usercenter
```

#### 3. RPC æœåŠ¡å¼€å‘

è®¾è®¡ Protocol Buffer å®šä¹‰ï¼Œç”Ÿæˆ gRPC æœåŠ¡ä»£ç ï¼š

```bash
# ç”Ÿæˆ RPC ä»£ç 
goctl rpc protoc <Protoæ–‡ä»¶> --go_out=<ç›®å½•> --go-grpc_out=<ç›®å½•> --zrpc_out=<ç›®å½•> --style=go_zero --home=deploy/goctl/1.7.3/

# ç¤ºä¾‹ï¼šç”Ÿæˆç”¨æˆ·ä¸­å¿ƒ RPC
make gen-rpc-usercenter
```

### ğŸ”„ å¼€å‘ç¯å¢ƒçƒ­é‡è½½

ä½¿ç”¨ modd å®ç°ä»£ç å˜æ›´è‡ªåŠ¨é‡å»ºï¼š

```bash
# å®‰è£… modd
go install github.com/cortesi/modd/cmd/modd@latest

# å¯åŠ¨çƒ­é‡è½½
modd
```

### ğŸ§ª æµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
go test ./...

# è¿è¡Œç‰¹å®šæœåŠ¡æµ‹è¯•
go test ./app/usercenter/...

# è¿è¡Œå•ä¸ªæµ‹è¯•æ–‡ä»¶
go test app/lottery/cmd/rpc/internal/logic/draw_lottery_test.go
```

### ğŸ“ ä»£ç ç”Ÿæˆå¿«æ·å‘½ä»¤

ä¸ºäº†ç®€åŒ–å¼€å‘æµç¨‹ï¼Œé¡¹ç›®æä¾›äº† Makefile ä¸­çš„å¿«æ·å‘½ä»¤ï¼š

| å‘½ä»¤ | åŠŸèƒ½ |
|------|------|
| `make gen-model-<service>` | ç”ŸæˆæŒ‡å®šæœåŠ¡çš„æ•°æ®æ¨¡å‹ |
| `make gen-api-<service>` | ç”ŸæˆæŒ‡å®šæœåŠ¡çš„ API ä»£ç  |
| `make gen-rpc-<service>` | ç”ŸæˆæŒ‡å®šæœåŠ¡çš„ RPC ä»£ç  |
| `make create-dirs NAME=<service>` | åˆ›å»ºæ–°æœåŠ¡ç›®å½•ç»“æ„ |

## ğŸ“Š ç›‘æ§ä¸è¿ç»´

### æ—¥å¿—æ”¶é›†æ¶æ„

ç³»ç»Ÿé‡‡ç”¨å®Œæ•´çš„æ—¥å¿—æ”¶é›†å’Œç›‘æ§æ–¹æ¡ˆï¼š

```
Application Logs â†’ Filebeat â†’ Kafka â†’ Go-Stash â†’ Elasticsearch â†’ Kibana
                                    â†˜
                                  Jaeger (é“¾è·¯è¿½è¸ª)
```

#### ç»„ä»¶è¯´æ˜

| ç»„ä»¶ | åŠŸèƒ½ | é…ç½®æ–‡ä»¶ |
|------|------|----------|
| **Filebeat** | æ—¥å¿—æ”¶é›†ï¼Œä»å®¹å™¨ä¸­æ”¶é›†åº”ç”¨æ—¥å¿— | `deploy/filebeat/conf/filebeat.yml` |
| **Kafka** | æ¶ˆæ¯é˜Ÿåˆ—ï¼Œä¼ è¾“æ—¥å¿—æ•°æ® | é€šè¿‡ Docker Compose é…ç½® |
| **Go-Stash** | æ—¥å¿—å¤„ç†ï¼Œä» Kafka æ¶ˆè´¹å¹¶å¤„ç†æ—¥å¿— | `deploy/go-stash/etc/config.yaml` |
| **Elasticsearch** | æ—¥å¿—å­˜å‚¨å’Œç´¢å¼• | é€šè¿‡ Docker Compose é…ç½® |
| **Kibana** | æ—¥å¿—å¯è§†åŒ–å’ŒæŸ¥è¯¢ | Web UI ç•Œé¢ |
| **Jaeger** | åˆ†å¸ƒå¼é“¾è·¯è¿½è¸ª | è¿½è¸ªè¯·æ±‚åœ¨å¾®æœåŠ¡é—´çš„è°ƒç”¨é“¾ |

### æ€§èƒ½ç›‘æ§

- **é“¾è·¯è¿½è¸ª**: ä½¿ç”¨ Jaeger ç›‘æ§è¯·æ±‚è°ƒç”¨é“¾
- **æŒ‡æ ‡æ”¶é›†**: go-zero å†…ç½® Prometheus æŒ‡æ ‡
- **å¥åº·æ£€æŸ¥**: å„æœåŠ¡æä¾›å¥åº·æ£€æŸ¥ç«¯ç‚¹
- **æ—¥å¿—åˆ†æ**: ELK å †æ ˆè¿›è¡Œæ—¥å¿—åˆ†æ

## â“ å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ

### ç¯å¢ƒé…ç½®é—®é¢˜

#### Q: go-zero å¦‚ä½•è¯»å–ç¯å¢ƒå˜é‡ï¼Ÿ
**A:** éœ€è¦åœ¨é…ç½®åŠ è½½æ—¶ä½¿ç”¨ `conf.UseEnv()` é€‰é¡¹ï¼š
```go
conf.MustLoad(*configFile, &c, conf.UseEnv())
```

#### Q: å¾®ä¿¡å°ç¨‹åºæ¶ˆæ¯å›è°ƒ Token éªŒè¯å¤±è´¥ï¼Ÿ
**A:** è¿™æ˜¯ç”±äºè‡ªå®šä¹‰ goctl æ¨¡æ¿å¯¹è¿”å›å€¼è¿›è¡Œäº†å°è£…å¯¼è‡´çš„ã€‚è§£å†³æ–¹æ¡ˆï¼š
- åœ¨å¾®ä¿¡å›è°ƒæ¥å£ä¸­ä½¿ç”¨åŸç”Ÿ HTTP å“åº”
- æˆ–ä¿®æ”¹ goctl æ¨¡æ¿ï¼Œé’ˆå¯¹å¾®ä¿¡å›è°ƒæ¥å£ç‰¹æ®Šå¤„ç†

### Docker ç›¸å…³é—®é¢˜

#### Q: WSL ç¯å¢ƒä¸‹ MySQL æƒé™é—®é¢˜ï¼Ÿ
**A:** è¿™æ˜¯å·²çŸ¥çš„ Docker for Windows é—®é¢˜ï¼Œå‚è€ƒï¼š[#4824](https://github.com/docker/for-win/issues/4824)

ä¸´æ—¶è§£å†³æ–¹æ¡ˆï¼š
```bash
# ä¿®æ”¹æ–‡ä»¶æƒé™
sudo chmod -R 755 ./data
sudo chown -R $USER:$USER ./data
```

#### Q: Windows Docker Desktop æ—¥å¿—æ˜ å°„é—®é¢˜ï¼Ÿ
**A:** åœ¨ WSL2 ç¯å¢ƒä¸­æ˜ å°„ Docker Desktop æ•°æ®ï¼š

```bash
# 1. æ˜ å°„ Docker Desktop æ•°æ®åˆ° H: ç›˜
net use h: \\wsl$\docker-desktop-data

# 2. åœ¨ WSL ä¸­åˆ›å»ºæŒ‚è½½ç‚¹
mkdir -p /mnt/docker

# 3. æŒ‚è½½åˆ° WSL
sudo mount -t drvfs H: /mnt/docker

# 4. åœ¨ WSL ç¯å¢ƒä¸­è¿è¡Œ Docker Compose
docker-compose -f docker-compose-env.yml up -d
```

### å¼€å‘è°ƒè¯•

#### Q: å¦‚ä½•è°ƒè¯•ç‰¹å®šå¾®æœåŠ¡ï¼Ÿ
**A:** å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•ï¼š
```bash
# 1. æŸ¥çœ‹æœåŠ¡æ—¥å¿—
docker-compose logs -f <service-name>

# 2. è¿›å…¥å®¹å™¨è°ƒè¯•
docker exec -it <container-name> /bin/bash

# 3. ä½¿ç”¨ modd è¿›è¡Œæœ¬åœ°è°ƒè¯•
modd
```

#### Q: å¦‚ä½•é‡æ–°ç”Ÿæˆä»£ç ï¼Ÿ
**A:** ä½¿ç”¨é¡¹ç›®æä¾›çš„ Make å‘½ä»¤ï¼š
```bash
# é‡æ–°ç”Ÿæˆæ‰€æœ‰ä»£ç 
make gen-model-<service>
make gen-api-<service>  
make gen-rpc-<service>
```

## ğŸ¤ è´¡çŒ®æŒ‡å—

### å¼€å‘è§„èŒƒ

1. **ä»£ç é£æ ¼**: éµå¾ª Go å®˜æ–¹ä»£ç è§„èŒƒ
2. **æäº¤è§„èŒƒ**: ä½¿ç”¨è¯­ä¹‰åŒ–æäº¤ä¿¡æ¯
3. **æµ‹è¯•è¦æ±‚**: æ–°åŠŸèƒ½éœ€è¦åŒ…å«å•å…ƒæµ‹è¯•
4. **æ–‡æ¡£æ›´æ–°**: é‡è¦å˜æ›´éœ€è¦æ›´æ–°æ–‡æ¡£

### æäº¤æµç¨‹

1. Fork é¡¹ç›®åˆ°ä¸ªäººä»“åº“
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯: `git checkout -b feature/amazing-feature`
3. æäº¤å˜æ›´: `git commit -m 'Add some amazing feature'`
4. æ¨é€åˆ†æ”¯: `git push origin feature/amazing-feature`
5. æäº¤ Pull Request

### é—®é¢˜åé¦ˆ

- ğŸ› Bug æŠ¥å‘Š: [GitHub Issues](https://github.com/jialechen7/go-lottery/issues)
- ğŸ’¡ åŠŸèƒ½å»ºè®®: [GitHub Discussions](https://github.com/jialechen7/go-lottery/discussions)

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ [MIT License](LICENSE) å¼€æºåè®®ã€‚

## ğŸ™ è‡´è°¢

- æ„Ÿè°¢ [go-zero](https://github.com/zeromicro/go-zero) å›¢é˜Ÿæä¾›çš„ä¼˜ç§€å¾®æœåŠ¡æ¡†æ¶
- æ„Ÿè°¢ [Mikaelemmmm](https://github.com/Mikaelemmmm) çš„ [go-zero-looklook](https://github.com/Mikaelemmmm/go-zero-looklook) é¡¹ç›®æä¾›çš„æ¶æ„å‚è€ƒ
- æ„Ÿè°¢æ‰€æœ‰ä¸ºå¼€æºç¤¾åŒºåšå‡ºè´¡çŒ®çš„å¼€å‘è€…ä»¬

---

<div align="center">

**â­ å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·ç»™ä¸€ä¸ªæ˜Ÿæ ‡æ”¯æŒï¼**

Made with â¤ï¸ by [jialechen7](https://github.com/jialechen7)

</div>
